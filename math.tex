\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{commath}
\usepackage{mathtools}

% For multipage align*
\allowdisplaybreaks

\title{Math Notes for Compound Interest}
\author{}
\date{}

\begin{document}
\maketitle

First let's calculate the debt after a time period $t$ given a principal $P$, an
interest rate $r$, a compound frequency $f$, and a cyclic payment $p$.
\begin{align*}
    a &= 1 + \frac{r}{n}\\
    D_0 &= P\\
    D_1 &= aP - p\\
    D_2 &= a(aP - p) - p\\
        &= a^2 P - p (a + 1)\\
        &\vdots\\
    D_{nt} &= a^{nt} P - p \sum_{i = 0}^{nt - 1} a^i
\end{align*}

Remember that we can find the solution to the finite exponential series as so
\begin{align*}
    x &= \sum_{i = 0}^{nt - 1} a^i\\
    ax &= \sum_{i = 1}^{nt} a^i\\
    ax - a^{nt} + 1 &= \sum_{i = 0}^{nt - 1} a^i\\
    ax - a^{nt} + 1 &= x\\
    (1 - a) x &= 1 - a^{nt}\\
    x &= \frac{1 - a^{nt}}{1 - a}
\end{align*}

Plugging this in gives us our debt calculation.
\begin{align*}
    D_{nt} &= a^{nt} P - p \frac{1 - a^{nt}}{1 - a}\\
           &= a^{nt} P - p \frac{n (a^{nt} - 1)}{r}
\end{align*}

From here we can calculate the minimum payment needed to pay off all debts in
a certain time frame.
\begin{align*}
    0 &= D_{nt}\\
    0 &= a^{nt} P - p \frac{n (a^{nt} - 1)}{r}\\
    p &= \frac{r a^{nt}}{n (a^{nt} - 1)} P
\end{align*}

Taking the limit of $t$ we can also find the minimum payment needed to maintain
debt.
\begin{align*}
    p_\text{min} &= \lim_{t \to \infty} \frac{r a^{nt}}{n (a^{nt} - 1)} P\\
                 &= \frac{r}{n} P
\end{align*}

We can also calculate how long it will take to pay off all debts.
\begin{align*}
    0 &= a^{nt} P - p \frac{n (a^{nt} - 1)}{r}\\
    0 &= ra^{nt} P - np (a^{nt} - 1)\\
    -np &= (rP - np) a^{nt}\\
    a^{nt} &= \frac{np}{np - rP}\\
    nt &= \frac{\ln{np} - \ln\del{np - rP}}{\ln{a}}\\
    t &= \frac{\ln{np} - \ln\del{np - rP}}{n\ln{a}}
\end{align*}

We can also take the derivative of $t$ with respect to $p$ to find the optimal
trade-off point.
\begin{align*}
    \dpd{t}{p} &= -\delta\\
    \frac{\frac{n}{np} - \frac{n}{np - rP}}{n \ln{a}} &= -\delta\\
    \frac{\frac{1}{np} - \frac{1}{np - rP}}{\ln{a}} &= -\delta\\
    \frac{1}{np} - \frac{1}{np - rP} &= -\delta \ln{a}\\
    np - rP - np &= -\delta \ln{a} np (np - rP)\\
    -rP &= -\delta \ln{a} np (np - rP)\\
    n^2 p^2 - nrP p &= \frac{rP}{\delta \ln{a}}\\
    n^2 p^2 - nrP p - \frac{rP}{\delta \ln{a}} &= 0\\
    p &= \frac{nrP \pm \sqrt{n^2r^2P^2 + \frac{4n^2 rP}{\delta \ln{a}}}}{2n^2}\\
      &= \frac{rP \pm \sqrt{r^2P^2 + \frac{4rP}{\delta \ln{a}}}}{2n}
\end{align*}

If we consider $\delta$ to be
$\frac{\Delta\text{time to payoff}}{\Delta\text{payment}}$
Then $\delta = \frac{1}{5}$ would represent the point where we have to pay \$5
more for a decrease of 1 year in time to payoff.

We can also consider the case for deriving by the principal.
\begin{align*}
    \dpd{D_{nt}}{P} &= \delta\\
    a^{nt} &= \delta\\
    p &= \frac{r a^{nt}}{n (a^{nt} - 1)} P\\
    p &= \frac{r \delta}{n (\delta - 1)} P
\end{align*}

Note that we must have $\delta > 1$.
In this case $\delta = 5$ would mean a \$1 increase in principal increases the
total paid amount by \$5.

\end{document}

